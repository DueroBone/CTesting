#include "EngishScorer.h"

const double bigram_table[26][26] = {
    {0.00060473, 0.00188520, 0.00219760, 0.00248284, 0.00089336, 0.00080322, 0.00131072, 0.00157805, 0.00426864, 0.00003828, 0.00163855, 0.00854962, 0.00350770, 0.02373032, 0.00012903, 0.00087886, 0.00000525, 0.00666874, 0.00584545, 0.01014959, 0.00108259, 0.00257267, 0.00097609, 0.00004569, 0.00305145, 0.00022133},
    {0.00113878, 0.00013366, 0.00000988, 0.00002253, 0.00591491, 0.00001605, 0.00000340, 0.00003766, 0.00055997, 0.00001297, 0.00000864, 0.00096313, 0.00001266, 0.00003951, 0.00133356, 0.00000216, 0.00000000, 0.00156107, 0.00022350, 0.00011360, 0.00200621, 0.00000185, 0.00003025, 0.00000000, 0.00093843, 0.00000309},
    {0.00273967, 0.00000278, 0.00036179, 0.00000401, 0.00275418, 0.00000093, 0.00000062, 0.00405687, 0.00078532, 0.00000031, 0.00070105, 0.00058313, 0.00000031, 0.00000031, 0.00330057, 0.00000031, 0.00000525, 0.00058961, 0.00000648, 0.00044853, 0.00051706, 0.00000000, 0.00001327, 0.00000000, 0.00012657, 0.00000000},
    {0.00664466, 0.00168609, 0.00078470, 0.00082669, 0.00446466, 0.00125454, 0.00103289, 0.00289062, 0.00414886, 0.00047663, 0.00014416, 0.00069642, 0.00121194, 0.00088194, 0.00389450, 0.00053559, 0.00000741, 0.00153545, 0.00354413, 0.00754544, 0.00151137, 0.00010527, 0.00235689, 0.00000000, 0.00055966, 0.00006236},
    {0.01133467, 0.00242326, 0.00398927, 0.00855641, 0.00470482, 0.00365619, 0.00184137, 0.00408836, 0.00449553, 0.00039883, 0.00118323, 0.00767169, 0.00545804, 0.01041568, 0.00417819, 0.00312122, 0.00007903, 0.01498962, 0.01273830, 0.01057713, 0.00118693, 0.00238097, 0.00403742, 0.00023893, 0.00331569, 0.00019324},
    {0.00239980, 0.00034944, 0.00016299, 0.00018367, 0.00178889, 0.00101900, 0.00051243, 0.00086095, 0.00224360, 0.00052478, 0.00006359, 0.00059763, 0.00059486, 0.00012996, 0.00544507, 0.00017534, 0.00000123, 0.00153267, 0.00046335, 0.00560436, 0.00049268, 0.00002809, 0.00024387, 0.00000000, 0.00027474, 0.00009631},
    {0.00232972, 0.00016083, 0.00008211, 0.00020806, 0.00153638, 0.00017472, 0.00009261, 0.00263101, 0.00114742, 0.00002531, 0.00002284, 0.00038124, 0.00028740, 0.00026363, 0.00334317, 0.00007038, 0.00000062, 0.00101993, 0.00109000, 0.00121904, 0.00039729, 0.00001235, 0.00023677, 0.00000000, 0.00033586, 0.00000247},
    {0.01556225, 0.00046829, 0.00024665, 0.00029233, 0.04027854, 0.00038680, 0.00020991, 0.00095881, 0.01099325, 0.00007841, 0.00008489, 0.00016484, 0.00047230, 0.00028801, 0.00660947, 0.00022226, 0.00001235, 0.00109834, 0.00076896, 0.00435816, 0.00114032, 0.00001945, 0.00068438, 0.00000000, 0.00184692, 0.00001543},
    {0.00136752, 0.00046860, 0.00264305, 0.00311936, 0.00218772, 0.00139067, 0.00173116, 0.00043896, 0.00002315, 0.00006637, 0.00035130, 0.00415658, 0.00318234, 0.01453213, 0.00158114, 0.00050132, 0.00010465, 0.00256001, 0.00897624, 0.00790846, 0.00004353, 0.00161417, 0.00074025, 0.00010557, 0.00000401, 0.00007594},
    {0.00034759, 0.00000000, 0.00000000, 0.00000000, 0.00109309, 0.00000000, 0.00000000, 0.00000000, 0.00000309, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00070166, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00059856, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000},
    {0.00037476, 0.00006297, 0.00004044, 0.00002099, 0.00265725, 0.00006236, 0.00000895, 0.00007810, 0.00164442, 0.00000864, 0.00001852, 0.00006699, 0.00004353, 0.00064054, 0.00032197, 0.00001204, 0.00000000, 0.00001698, 0.00028925, 0.00029017, 0.00009570, 0.00000247, 0.00009292, 0.00000000, 0.00002902, 0.00000247},
    {0.00344535, 0.00117736, 0.00041581, 0.00295360, 0.00572444, 0.00068191, 0.00022319, 0.00047909, 0.00303077, 0.00004630, 0.00028184, 0.00812331, 0.00036086, 0.00048990, 0.00487831, 0.00028956, 0.00000185, 0.00019479, 0.00167189, 0.00320673, 0.00030345, 0.00043989, 0.00040254, 0.00000000, 0.00128078, 0.00000772},
    {0.00533333, 0.00083811, 0.00013922, 0.00009909, 0.00596492, 0.00030005, 0.00011175, 0.00035870, 0.00213092, 0.00004383, 0.00003334, 0.00007872, 0.00065227, 0.00023029, 0.00263687, 0.00049299, 0.00000123, 0.00009168, 0.00080724, 0.00172838, 0.00056522, 0.00001482, 0.00047786, 0.00000000, 0.00153885, 0.00000741},
    {0.00416337, 0.00057603, 0.00157311, 0.02015841, 0.00532314, 0.00054392, 0.00651347, 0.00167652, 0.00212135, 0.00025838, 0.00034636, 0.00034481, 0.00053867, 0.00051614, 0.00637394, 0.00023152, 0.00004167, 0.00014200, 0.00341602, 0.01220210, 0.00067882, 0.00009199, 0.00081712, 0.00000000, 0.00080415, 0.00002037},
    {0.00126935, 0.00086743, 0.00062017, 0.00279338, 0.00051459, 0.01197459, 0.00053620, 0.00128788, 0.00105327, 0.00027412, 0.00083471, 0.00211240, 0.00456591, 0.00819802, 0.00179105, 0.00165337, 0.00000463, 0.01108926, 0.00221334, 0.00669930, 0.00984058, 0.00125608, 0.00294279, 0.00005680, 0.00056893, 0.00005186},
    {0.00169505, 0.00004445, 0.00001080, 0.00000710, 0.00222940, 0.00007162, 0.00000895, 0.00102024, 0.00068901, 0.00000617, 0.00000340, 0.00155150, 0.00005340, 0.00001821, 0.00180772, 0.00034605, 0.00000062, 0.00190033, 0.00017935, 0.00101098, 0.00058189, 0.00000154, 0.00007100, 0.00000000, 0.00004260, 0.00000093},
    {0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00029758, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000},
    {0.00483324, 0.00057664, 0.00073963, 0.00458875, 0.01289450, 0.00070228, 0.00059084, 0.00098165, 0.00510366, 0.00010804, 0.00059733, 0.00052540, 0.00083749, 0.00163392, 0.00493943, 0.00035407, 0.00000340, 0.00056183, 0.00324315, 0.00481688, 0.00124342, 0.00064085, 0.00074889, 0.00000463, 0.00129312, 0.00001605},
    {0.00857648, 0.00101900, 0.00114094, 0.00059146, 0.00756643, 0.00101808, 0.00044421, 0.00730249, 0.00294464, 0.00008860, 0.00024788, 0.00068067, 0.00082329, 0.00076062, 0.00604796, 0.00161818, 0.00001636, 0.00103969, 0.00388277, 0.00891265, 0.00144037, 0.00007316, 0.00206671, 0.00000000, 0.00034728, 0.00001050},
    {0.00461931, 0.00107086, 0.00073469, 0.00062881, 0.00517311, 0.00085046, 0.00034975, 0.05115943, 0.00476872, 0.00019540, 0.00012873, 0.00067512, 0.00080786, 0.00066894, 0.01093213, 0.00032753, 0.00000772, 0.00198367, 0.00286994, 0.00512990, 0.00138666, 0.00003704, 0.00211672, 0.00000031, 0.00144778, 0.00001543},
    {0.00066493, 0.00052231, 0.00049793, 0.00084829, 0.00043341, 0.00016145, 0.00110513, 0.00029820, 0.00061276, 0.00000803, 0.00008273, 0.00159225, 0.00049638, 0.00493017, 0.00009199, 0.00181821, 0.00000123, 0.00331106, 0.00418838, 0.00383862, 0.00002963, 0.00000525, 0.00014694, 0.00000062, 0.00004229, 0.00003951},
    {0.00061399, 0.00000000, 0.00000000, 0.00000000, 0.00701078, 0.00000000, 0.00000000, 0.00000000, 0.00134745, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00037352, 0.00000000, 0.00000000, 0.00000000, 0.00000031, 0.00000000, 0.00000123, 0.00000000, 0.00000000, 0.00000000, 0.00002624, 0.00000000},
    {0.00340645, 0.00007625, 0.00003427, 0.00004137, 0.00335243, 0.00006112, 0.00002593, 0.00430506, 0.00462888, 0.00001482, 0.00000741, 0.00015990, 0.00008366, 0.00079304, 0.00189539, 0.00001698, 0.00000000, 0.00029851, 0.00026455, 0.00055256, 0.00003210, 0.00000093, 0.00012440, 0.00000000, 0.00003859, 0.00000093},
    {0.00006390, 0.00000370, 0.00009199, 0.00000679, 0.00010743, 0.00000216, 0.00000185, 0.00003457, 0.00000525, 0.00000000, 0.00000031, 0.00000247, 0.00000525, 0.00000154, 0.00001019, 0.00002562, 0.00000000, 0.00000123, 0.00000772, 0.00007440, 0.00000031, 0.00000000, 0.00000463, 0.00000000, 0.00000494, 0.00000000},
    {0.00134900, 0.00066802, 0.00047817, 0.00036704, 0.00243005, 0.00065659, 0.00041427, 0.00073006, 0.00093936, 0.00006946, 0.00009755, 0.00043156, 0.00067697, 0.00030808, 0.00242048, 0.00064209, 0.00000309, 0.00035130, 0.00196454, 0.00168301, 0.00027937, 0.00007470, 0.00087639, 0.00000370, 0.00016423, 0.00000309},
    {0.00023770, 0.00000617, 0.00000370, 0.00000185, 0.00025560, 0.00000062, 0.00000154, 0.00000803, 0.00018491, 0.00000031, 0.00000309, 0.00000185, 0.00000401, 0.00000247, 0.00003272, 0.00001667, 0.00000000, 0.00004137, 0.00000587, 0.00001574, 0.00001482, 0.00000000, 0.00000741, 0.00000000, 0.00000000, 0.00007100},
};

double calculateBigramScore(const int *text, int length)
{
  double score = 0.0;
  for (int i = 0; i < (length - 1); i++)
  {
    int first_char = text[i];
    int second_char = text[i + 1];
    if (first_char >= 0 && first_char < 26 && second_char >= 0 && second_char < 26)
    {
      score += bigram_table[first_char][second_char];
    }
  }
  return score;
}